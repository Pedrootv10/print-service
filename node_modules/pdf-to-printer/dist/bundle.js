!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(global,(function(){return(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{getDefaultPrinter:()=>m,getPrinters:()=>h,print:()=>p});const n=require("path");var r=e.n(n);const o=require("fs");var i=e.n(o);function a(e){return String(e).match(/\\?.|^$/g).reduce(((e,t)=>('"'===t?e.quote^=1:e.quote||" "!==t?e.a[e.a.length-1]+=t.replace(/\\(.)/,"$1"):e.a.push(""),e)),{a:[""]}).a}const c=require("child_process"),u=require("util"),s=e.n(u)().promisify(c.execFile),f="electron"in process.versions&&process.mainModule&&process.mainModule.filename.includes("app.asar");const l=["-print-to","-print-to-default","-print-dialog"];function p(e,t={}){return n=this,o=void 0,u=function*(){if(!e)throw"No PDF specified";if("string"!=typeof e)throw"Invalid PDF name";if(!i().existsSync(e))throw"No such file";let n=t.sumatraPdfPath||r().join(__dirname,"SumatraPDF.exe");var o;t.sumatraPdfPath||(o=n,n=f?o.replace("app.asar","app.asar.unpacked"):o);const c=[],{printer:u,win32:p}=t;if(p){if(!Array.isArray(p))throw"options.win32 should be an array";p.map(a).reduce(((e,t)=>e.concat(t)),[]).forEach((e=>c.push(e)))}let d=!1;c.some((e=>!!(l.indexOf(e)>-1)&&(d=!0,!0))),d||(u?c.push("-print-to",u):c.push("-print-to-default"),c.push("-silent")),c.push(e);try{yield s(n,c)}catch(e){throw e}},new((c=void 0)||(c=Promise))((function(e,t){function r(e){try{a(u.next(e))}catch(e){t(e)}}function i(e){try{a(u.throw(e))}catch(e){t(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof c?n:new c((function(e){e(n)}))).then(r,i)}a((u=u.apply(n,o||[])).next())}));var n,o,c,u}function d(e){const t={deviceId:"",name:""};return{isValid:e.split(/\r?\n/).some((e=>{const[n,r]=e.split(":").map((e=>e.trim())),o=n.toLowerCase();return"deviceid"===o&&(t.deviceId=r),"name"===o&&(t.name=r),!(!t.deviceId||!t.name)})),printerData:t}}const h=function(){return e=this,t=void 0,r=function*(){try{const{stdout:e}=yield s("Powershell.exe",["-Command","Get-CimInstance Win32_Printer -Property DeviceID,Name"]);return function(e){const t=[];return e.split(/(\r?\n){2,}/).map((e=>e.trim())).filter((e=>!!e)).forEach((e=>{const{isValid:n,printerData:r}=d(e);n&&t.push(r)})),t}(e)}catch(e){throw e}},new((n=void 0)||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}));var e,t,n,r};const m=function(){return e=this,t=void 0,r=function*(){try{const{stdout:e}=yield s("Powershell.exe",["-Command","Get-CimInstance Win32_Printer -Property DeviceID,Name -Filter Default=true"]),t=e.trim();if(!e)return null;const{isValid:n,printerData:r}=d(t);return n?r:null}catch(e){throw e}},new((n=void 0)||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}));var e,t,n,r},v=require("os");if("win32"!==e.n(v)().platform())throw new Error("Platform not supported");return t})()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QStCeEMsUUFBUSxNQ0s3QyxHQUFzQixVLE1BQWxCLGNBQ0YsTUFBTSxJQUFJeUQsTUFBTSwwQiIsInNvdXJjZXMiOlsid2VicGFjazovL3BkZi10by1wcmludGVyL3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9wZGYtdG8tcHJpbnRlci93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9wZGYtdG8tcHJpbnRlci93ZWJwYWNrL3J1bnRpbWUvY29tcGF0IGdldCBkZWZhdWx0IGV4cG9ydCIsIndlYnBhY2s6Ly9wZGYtdG8tcHJpbnRlci93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vcGRmLXRvLXByaW50ZXIvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9wZGYtdG8tcHJpbnRlci93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3BkZi10by1wcmludGVyL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJwYXRoXCIiLCJ3ZWJwYWNrOi8vcGRmLXRvLXByaW50ZXIvZXh0ZXJuYWwgbm9kZS1jb21tb25qcyBcImZzXCIiLCJ3ZWJwYWNrOi8vcGRmLXRvLXByaW50ZXIvLi9zcmMvdXRpbHMvc3BsaXQtYXJncy50cyIsIndlYnBhY2s6Ly9wZGYtdG8tcHJpbnRlci9leHRlcm5hbCBub2RlLWNvbW1vbmpzIFwiY2hpbGRfcHJvY2Vzc1wiIiwid2VicGFjazovL3BkZi10by1wcmludGVyL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJ1dGlsXCIiLCJ3ZWJwYWNrOi8vcGRmLXRvLXByaW50ZXIvLi9zcmMvdXRpbHMvZXhlYy1maWxlLWFzeW5jLnRzIiwid2VicGFjazovL3BkZi10by1wcmludGVyLy4vc3JjL3V0aWxzL2VsZWN0cm9uLXV0aWwudHMiLCJ3ZWJwYWNrOi8vcGRmLXRvLXByaW50ZXIvLi9zcmMvcHJpbnQvcHJpbnQudHMiLCJ3ZWJwYWNrOi8vcGRmLXRvLXByaW50ZXIvLi9zcmMvdXRpbHMvd2luZG93cy1wcmludGVyLXZhbGlkLnRzIiwid2VicGFjazovL3BkZi10by1wcmludGVyLy4vc3JjL2dldC1wcmludGVycy9nZXQtcHJpbnRlcnMudHMiLCJ3ZWJwYWNrOi8vcGRmLXRvLXByaW50ZXIvLi9zcmMvZ2V0LWRlZmF1bHQtcHJpbnRlci9nZXQtZGVmYXVsdC1wcmludGVyLnRzIiwid2VicGFjazovL3BkZi10by1wcmludGVyL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJvc1wiIiwid2VicGFjazovL3BkZi10by1wcmludGVyLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSB7XG5cdFx0dmFyIGEgPSBmYWN0b3J5KCk7XG5cdFx0Zm9yKHZhciBpIGluIGEpICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgPyBleHBvcnRzIDogcm9vdClbaV0gPSBhW2ldO1xuXHR9XG59KShnbG9iYWwsIGZ1bmN0aW9uKCkge1xucmV0dXJuICIsIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcInBhdGhcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJmc1wiKTsiLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBzcGxpdEFyZ3MoaW5wdXQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgLy8gQHRzLWlnbm9yZVxuICByZXR1cm4gU3RyaW5nKGlucHV0KVxuICAgIC5tYXRjaCgvXFxcXD8ufF4kL2cpXG4gICAgLnJlZHVjZShcbiAgICAgIChwLCBjKSA9PiB7XG4gICAgICAgIGlmIChjID09PSAnXCInKSB7XG4gICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgIHAucXVvdGUgXj0gMTtcbiAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIH0gZWxzZSBpZiAoIXAucXVvdGUgJiYgYyA9PT0gXCIgXCIpIHtcbiAgICAgICAgICBwLmEucHVzaChcIlwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwLmFbcC5hLmxlbmd0aCAtIDFdICs9IGMucmVwbGFjZSgvXFxcXCguKS8sIFwiJDFcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHA7XG4gICAgICB9LFxuICAgICAgeyBhOiBbXCJcIl0gfVxuICAgICkuYTtcbn1cbiIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwiY2hpbGRfcHJvY2Vzc1wiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcInV0aWxcIik7IiwiaW1wb3J0IHsgZXhlY0ZpbGUgfSBmcm9tIFwiY2hpbGRfcHJvY2Vzc1wiO1xuaW1wb3J0IHV0aWwgZnJvbSBcInV0aWxcIjtcblxuY29uc3QgZXhlY0ZpbGVBc3luYyA9IHV0aWwucHJvbWlzaWZ5KGV4ZWNGaWxlKTtcblxuZXhwb3J0IGRlZmF1bHQgZXhlY0ZpbGVBc3luYztcbiIsIi8vIFRha2VuIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL3NpbmRyZXNvcmh1cy9lbGVjdHJvbi11dGlsL2Jsb2IvbWFzdGVyL25vZGUuanNcblxuY29uc3QgaXNFbGVjdHJvbiA9IFwiZWxlY3Ryb25cIiBpbiBwcm9jZXNzLnZlcnNpb25zO1xuXG5jb25zdCBpc1VzaW5nQXNhciA9XG4gIGlzRWxlY3Ryb24gJiZcbiAgcHJvY2Vzcy5tYWluTW9kdWxlICYmXG4gIHByb2Nlc3MubWFpbk1vZHVsZS5maWxlbmFtZS5pbmNsdWRlcyhcImFwcC5hc2FyXCIpO1xuXG5mdW5jdGlvbiBmaXhQYXRoRm9yQXNhclVucGFjayhwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gaXNVc2luZ0FzYXIgPyBwYXRoLnJlcGxhY2UoXCJhcHAuYXNhclwiLCBcImFwcC5hc2FyLnVucGFja2VkXCIpIDogcGF0aDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZml4UGF0aEZvckFzYXJVbnBhY2s7XG4iLCJpbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0IHNwbGl0QXJncyBmcm9tIFwiLi4vdXRpbHMvc3BsaXQtYXJnc1wiO1xuaW1wb3J0IGV4ZWNBc3luYyBmcm9tIFwiLi4vdXRpbHMvZXhlYy1maWxlLWFzeW5jXCI7XG5pbXBvcnQgZml4UGF0aEZvckFzYXJVbnBhY2sgZnJvbSBcIi4uL3V0aWxzL2VsZWN0cm9uLXV0aWxcIjtcblxuZXhwb3J0IGludGVyZmFjZSBQcmludE9wdGlvbnMge1xuICBwcmludGVyPzogc3RyaW5nO1xuICB3aW4zMj86IHN0cmluZ1tdO1xuICBzdW1hdHJhUGRmUGF0aD86IHN0cmluZztcbn1cblxuY29uc3QgdmFsaWREZXN0aW5hdGlvbkFyZ3MgPSBbXG4gIFwiLXByaW50LXRvXCIsXG4gIFwiLXByaW50LXRvLWRlZmF1bHRcIixcbiAgXCItcHJpbnQtZGlhbG9nXCIsXG5dO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBwcmludChcbiAgcGRmOiBzdHJpbmcsXG4gIG9wdGlvbnM6IFByaW50T3B0aW9ucyA9IHt9XG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCFwZGYpIHRocm93IFwiTm8gUERGIHNwZWNpZmllZFwiO1xuICBpZiAodHlwZW9mIHBkZiAhPT0gXCJzdHJpbmdcIikgdGhyb3cgXCJJbnZhbGlkIFBERiBuYW1lXCI7XG4gIGlmICghZnMuZXhpc3RzU3luYyhwZGYpKSB0aHJvdyBcIk5vIHN1Y2ggZmlsZVwiO1xuXG4gIGxldCBzdW1hdHJhUGRmID1cbiAgICBvcHRpb25zLnN1bWF0cmFQZGZQYXRoIHx8IHBhdGguam9pbihfX2Rpcm5hbWUsIFwiU3VtYXRyYVBERi5leGVcIik7XG4gIGlmICghb3B0aW9ucy5zdW1hdHJhUGRmUGF0aCkgc3VtYXRyYVBkZiA9IGZpeFBhdGhGb3JBc2FyVW5wYWNrKHN1bWF0cmFQZGYpO1xuXG4gIGNvbnN0IGFyZ3M6IHN0cmluZ1tdID0gW107XG5cbiAgY29uc3QgeyBwcmludGVyLCB3aW4zMiB9ID0gb3B0aW9ucztcblxuICBpZiAod2luMzIpIHtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkod2luMzIpKSB0aHJvdyBcIm9wdGlvbnMud2luMzIgc2hvdWxkIGJlIGFuIGFycmF5XCI7XG4gICAgd2luMzJcbiAgICAgIC5tYXAoc3BsaXRBcmdzKVxuICAgICAgLnJlZHVjZSgoYWNjLCBhcmcpID0+IGFjYy5jb25jYXQoYXJnKSwgW10pXG4gICAgICAuZm9yRWFjaCgoYXJnKSA9PiBhcmdzLnB1c2goYXJnKSk7XG4gIH1cblxuICBsZXQgdmFsaWREZXN0aW5hdGlvbiA9IGZhbHNlO1xuICBhcmdzLnNvbWUoKGEpID0+IHtcbiAgICBjb25zdCBmdWxsTWF0Y2ggPSB2YWxpZERlc3RpbmF0aW9uQXJncy5pbmRleE9mKGEpID4gLTE7XG4gICAgaWYgKGZ1bGxNYXRjaCkge1xuICAgICAgdmFsaWREZXN0aW5hdGlvbiA9IHRydWU7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSk7XG5cbiAgaWYgKCF2YWxpZERlc3RpbmF0aW9uKSB7XG4gICAgaWYgKHByaW50ZXIpIHtcbiAgICAgIGFyZ3MucHVzaChcIi1wcmludC10b1wiLCBwcmludGVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXJncy5wdXNoKFwiLXByaW50LXRvLWRlZmF1bHRcIik7XG4gICAgfVxuICAgIGFyZ3MucHVzaChcIi1zaWxlbnRcIik7XG4gIH1cblxuICBhcmdzLnB1c2gocGRmKTtcblxuICB0cnkge1xuICAgIGF3YWl0IGV4ZWNBc3luYyhzdW1hdHJhUGRmLCBhcmdzKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUHJpbnRlciB9IGZyb20gXCIuLi9nZXQtZGVmYXVsdC1wcmludGVyL2dldC1kZWZhdWx0LXByaW50ZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNWYWxpZFByaW50ZXIoXG4gIHByaW50ZXI6IHN0cmluZ1xuKTogeyBpc1ZhbGlkOiBib29sZWFuOyBwcmludGVyRGF0YTogUHJpbnRlciB9IHtcbiAgY29uc3QgcHJpbnRlckRhdGE6IFByaW50ZXIgPSB7XG4gICAgZGV2aWNlSWQ6IFwiXCIsXG4gICAgbmFtZTogXCJcIixcbiAgfTtcblxuICBjb25zdCBpc1ZhbGlkID0gcHJpbnRlci5zcGxpdCgvXFxyP1xcbi8pLnNvbWUoKGxpbmUpID0+IHtcbiAgICBjb25zdCBbbGFiZWwsIHZhbHVlXSA9IGxpbmUuc3BsaXQoXCI6XCIpLm1hcCgoZWwpID0+IGVsLnRyaW0oKSk7XG5cbiAgICBjb25zdCBsb3dlckxhYmVsID0gbGFiZWwudG9Mb3dlckNhc2UoKTtcblxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBpZiAobG93ZXJMYWJlbCA9PT0gXCJkZXZpY2VpZFwiKSBwcmludGVyRGF0YS5kZXZpY2VJZCA9IHZhbHVlO1xuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGlmIChsb3dlckxhYmVsID09PSBcIm5hbWVcIikgcHJpbnRlckRhdGEubmFtZSA9IHZhbHVlO1xuXG4gICAgcmV0dXJuICEhKHByaW50ZXJEYXRhLmRldmljZUlkICYmIHByaW50ZXJEYXRhLm5hbWUpO1xuICB9KTtcblxuICByZXR1cm4ge1xuICAgIGlzVmFsaWQsXG4gICAgcHJpbnRlckRhdGEsXG4gIH07XG59XG4iLCJpbXBvcnQgZXhlY0ZpbGVBc3luYyBmcm9tIFwiLi4vdXRpbHMvZXhlYy1maWxlLWFzeW5jXCI7XG5pbXBvcnQgaXNWYWxpZFByaW50ZXIgZnJvbSBcIi4uL3V0aWxzL3dpbmRvd3MtcHJpbnRlci12YWxpZFwiO1xuaW1wb3J0IHsgUHJpbnRlciB9IGZyb20gXCIuLi9nZXQtZGVmYXVsdC1wcmludGVyL2dldC1kZWZhdWx0LXByaW50ZXJcIjtcblxuYXN5bmMgZnVuY3Rpb24gZ2V0UHJpbnRlcnMoKTogUHJvbWlzZTxQcmludGVyW10+IHtcbiAgZnVuY3Rpb24gc3Rkb3V0SGFuZGxlcihzdGRvdXQ6IHN0cmluZykge1xuICAgIGNvbnN0IHByaW50ZXJzOiBQcmludGVyW10gPSBbXTtcblxuICAgIHN0ZG91dFxuICAgICAgLnNwbGl0KC8oXFxyP1xcbil7Mix9LylcbiAgICAgIC5tYXAoKHByaW50ZXIpID0+IHByaW50ZXIudHJpbSgpKVxuICAgICAgLmZpbHRlcigocHJpbnRlcikgPT4gISFwcmludGVyKVxuICAgICAgLmZvckVhY2goKHByaW50ZXIpID0+IHtcbiAgICAgICAgY29uc3QgeyBpc1ZhbGlkLCBwcmludGVyRGF0YSB9ID0gaXNWYWxpZFByaW50ZXIocHJpbnRlcik7XG5cbiAgICAgICAgaWYgKCFpc1ZhbGlkKSByZXR1cm47XG5cbiAgICAgICAgcHJpbnRlcnMucHVzaChwcmludGVyRGF0YSk7XG4gICAgICB9KTtcblxuICAgIHJldHVybiBwcmludGVycztcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyBzdGRvdXQgfSA9IGF3YWl0IGV4ZWNGaWxlQXN5bmMoXCJQb3dlcnNoZWxsLmV4ZVwiLCBbXG4gICAgICBcIi1Db21tYW5kXCIsXG4gICAgICBcIkdldC1DaW1JbnN0YW5jZSBXaW4zMl9QcmludGVyIC1Qcm9wZXJ0eSBEZXZpY2VJRCxOYW1lXCIsXG4gICAgXSk7XG4gICAgcmV0dXJuIHN0ZG91dEhhbmRsZXIoc3Rkb3V0KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBnZXRQcmludGVycztcbiIsImltcG9ydCBleGVjRmlsZUFzeW5jIGZyb20gXCIuLi91dGlscy9leGVjLWZpbGUtYXN5bmNcIjtcbmltcG9ydCBpc1ZhbGlkUHJpbnRlciBmcm9tIFwiLi4vdXRpbHMvd2luZG93cy1wcmludGVyLXZhbGlkXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJpbnRlciB7XG4gIGRldmljZUlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0RGVmYXVsdFByaW50ZXIoKTogUHJvbWlzZTxQcmludGVyIHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc3Rkb3V0IH0gPSBhd2FpdCBleGVjRmlsZUFzeW5jKFwiUG93ZXJzaGVsbC5leGVcIiwgW1xuICAgICAgXCItQ29tbWFuZFwiLFxuICAgICAgXCJHZXQtQ2ltSW5zdGFuY2UgV2luMzJfUHJpbnRlciAtUHJvcGVydHkgRGV2aWNlSUQsTmFtZSAtRmlsdGVyIERlZmF1bHQ9dHJ1ZVwiLFxuICAgIF0pO1xuXG4gICAgY29uc3QgcHJpbnRlciA9IHN0ZG91dC50cmltKCk7XG5cbiAgICAvLyBJZiBzdGRvdXQgaXMgZW1wdHksIHRoZXJlIGlzIG5vIGRlZmF1bHQgcHJpbnRlclxuICAgIGlmICghc3Rkb3V0KSByZXR1cm4gbnVsbDtcblxuICAgIGNvbnN0IHsgaXNWYWxpZCwgcHJpbnRlckRhdGEgfSA9IGlzVmFsaWRQcmludGVyKHByaW50ZXIpO1xuXG4gICAgLy8gRGV2aWNlSUQgb3IgTmFtZSBub3QgZm91bmRcbiAgICBpZiAoIWlzVmFsaWQpIHJldHVybiBudWxsO1xuXG4gICAgcmV0dXJuIHByaW50ZXJEYXRhO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGdldERlZmF1bHRQcmludGVyO1xuIiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJvc1wiKTsiLCJleHBvcnQgeyBkZWZhdWx0IGFzIHByaW50IH0gZnJvbSBcIi4vcHJpbnQvcHJpbnRcIjtcbmV4cG9ydCB7IGRlZmF1bHQgYXMgZ2V0UHJpbnRlcnMgfSBmcm9tIFwiLi9nZXQtcHJpbnRlcnMvZ2V0LXByaW50ZXJzXCI7XG5leHBvcnQgeyBkZWZhdWx0IGFzIGdldERlZmF1bHRQcmludGVyIH0gZnJvbSBcIi4vZ2V0LWRlZmF1bHQtcHJpbnRlci9nZXQtZGVmYXVsdC1wcmludGVyXCI7XG5pbXBvcnQgb3MgZnJvbSBcIm9zXCI7XG5cbmlmIChvcy5wbGF0Zm9ybSgpICE9PSBcIndpbjMyXCIpIHtcbiAgdGhyb3cgbmV3IEVycm9yKFwiUGxhdGZvcm0gbm90IHN1cHBvcnRlZFwiKTtcbn1cbiJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJhIiwiaSIsImdsb2JhbCIsIl9fd2VicGFja19yZXF1aXJlX18iLCJnZXR0ZXIiLCJfX2VzTW9kdWxlIiwiZCIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJyZXF1aXJlIiwic3BsaXRBcmdzIiwiaW5wdXQiLCJTdHJpbmciLCJtYXRjaCIsInJlZHVjZSIsInAiLCJjIiwicXVvdGUiLCJsZW5ndGgiLCJyZXBsYWNlIiwicHVzaCIsImV4ZWNGaWxlIiwiaXNVc2luZ0FzYXIiLCJwcm9jZXNzIiwidmVyc2lvbnMiLCJtYWluTW9kdWxlIiwiZmlsZW5hbWUiLCJpbmNsdWRlcyIsInZhbGlkRGVzdGluYXRpb25BcmdzIiwicHJpbnQiLCJwZGYiLCJvcHRpb25zIiwic3VtYXRyYVBkZiIsInN1bWF0cmFQZGZQYXRoIiwiX19kaXJuYW1lIiwicGF0aCIsImFyZ3MiLCJwcmludGVyIiwid2luMzIiLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJhY2MiLCJhcmciLCJjb25jYXQiLCJmb3JFYWNoIiwidmFsaWREZXN0aW5hdGlvbiIsInNvbWUiLCJpbmRleE9mIiwiZXJyb3IiLCJpc1ZhbGlkUHJpbnRlciIsInByaW50ZXJEYXRhIiwiZGV2aWNlSWQiLCJuYW1lIiwiaXNWYWxpZCIsInNwbGl0IiwibGluZSIsImxhYmVsIiwiZWwiLCJ0cmltIiwibG93ZXJMYWJlbCIsInRvTG93ZXJDYXNlIiwic3Rkb3V0IiwicHJpbnRlcnMiLCJmaWx0ZXIiLCJzdGRvdXRIYW5kbGVyIiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9